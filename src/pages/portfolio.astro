---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

// Get all jobs for portfolio page
const allJobs = await getCollection('jobs');
const publishedJobs = allJobs
  .filter(job => job.data.status === 'published')
  .sort((a, b) => a.data.order - b.data.order);
---

<BaseLayout title="Portfolio - Alejandro Delgado">
  <main>
    <div class="container">
      <div class="section padding-block-start-10">
        <h1 class="heading-1 margin-block-end-8">Complete Portfolio</h1>
        
        {publishedJobs.map(job => (
          <div class="job-description padding-block-8">
            <h2 class="job-title margin-block-end-4">{job.data.title}</h2>
            <p><span class="job-label">Place = </span><span class="job-place">{job.data.place}</span>;</p>
            <p><span class="job-label">Type = </span>{job.data.type};</p>
            <p><span class="job-label">Period = </span>{job.data.period};</p>
            <p><span class="job-label">Tags = </span><span class="job-tags">{job.data.tags.join(', ')}</span>;</p>
            {job.data.industry && (
              <p><span class="job-label">Industry = </span>{job.data.industry};</p>
            )}
            <p>
              <span class="job-label">Tasks = </span>
              <span class="job-description_parentheses">(</span>
              <span class="job-description_brackets">{</span>
              <ul>
                {job.body.split('\n').filter(line => line.startsWith('- ')).map(task => (
                  <li>{task.replace('- ', '')}</li>
                ))}
              </ul>
              <span class="job-description_brackets">}</span>
              <span class="job-description_parentheses">)</span>;
            </p>
            <p><a href={`/jobs/${job.slug}/`}>Ver detalles completos â†’</a></p>
          </div>
        ))}
      </div>
    </div>
  </main>
</BaseLayout>